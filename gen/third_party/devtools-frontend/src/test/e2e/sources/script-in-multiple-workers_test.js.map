{"version":3,"file":"script-in-multiple-workers_test.js","sourceRoot":"","sources":["../../../../../../../../../third_party/devtools-frontend/src/test/e2e/sources/script-in-multiple-workers_test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assert} from 'chai';\n\nimport {\n  $$,\n  click,\n  getBrowserAndPages,\n  goToResource,\n  step,\n  timeout,\n  waitFor,\n  waitForFunction,\n} from '../../shared/helper.js';\nimport {describe, it} from '../../shared/mocha-extensions.js';\nimport {\n  addBreakpointForLine,\n  createSelectorsForWorkerFile,\n  getBreakpointDecorators,\n  getOpenSources,\n  openNestedWorkerFile,\n  RESUME_BUTTON,\n  retrieveTopCallFrameWithoutResuming,\n  SourceFileEvents,\n  waitForSourceFiles,\n} from '../helpers/sources-helpers.js';\n\nasync function validateSourceTabs() {\n  await step('Validate exactly one source file is open', async () => {\n    const openSources = await waitForFunction(async () => {\n      const sources = await getOpenSources();\n      return sources.length ? sources : undefined;\n    });\n    assert.deepEqual(openSources, ['multi-workers.js']);\n  });\n}\n\ndescribe('Multi-Workers', async function() {\n  // The tests in this suite are particularly slow, as they perform a lot of actions\n  if (this.timeout() !== 0) {\n    this.timeout(10000);\n  }\n\n  [false, true].forEach(sourceMaps => {\n    const withOrWithout = sourceMaps ? 'with source maps' : 'without source maps';\n    const targetPage = sourceMaps ? 'sources/multi-workers-sourcemap.html' : 'sources/multi-workers.html';\n    const scriptFile = sourceMaps ? 'multi-workers.min.js' : 'multi-workers.js';\n    function workerFileSelectors(workerIndex: number) {\n      return createSelectorsForWorkerFile(scriptFile, 'test/e2e/resources/sources', 'multi-workers.js', workerIndex);\n    }\n\n    async function validateNavigationTree() {\n      await step('Ensure 10 workers exist', async () => {\n        await waitFor(workerFileSelectors(10).rootSelector);\n      });\n    }\n\n    async function validateBreakpoints() {\n      assert.deepEqual(await getBreakpointDecorators(), [6, 12]);\n      assert.deepEqual(await getBreakpointDecorators(true), [6]);\n    }\n\n    describe(`loads scripts exactly once ${withOrWithout}`, () => {\n      beforeEach(async () => {\n        // Have the target load the page.\n        await goToResource(targetPage);\n\n        await step('Open sources panel', async () => {\n          await click('#tab-sources');\n        });\n\n        await validateNavigationTree();\n\n        await step('Open first worker file', async () => {\n          await openNestedWorkerFile(workerFileSelectors(1));\n        });\n\n        // Look at source tabs\n        await validateSourceTabs();\n      });\n\n      afterEach(async () => {\n        // Look at source tabs\n        await validateSourceTabs();\n      });\n\n      it('on reload', async () => {\n        // Reload page\n        await goToResource(targetPage);\n\n        // Check workers again\n        await validateNavigationTree();\n      });\n\n      it('upon break', async () => {\n        const {target} = getBrowserAndPages();\n\n        // Send message to a worker to trigger break\n        await target.evaluate('workers[3].postMessage({command:\"break\"});');\n\n        // Validate that we are paused by locating the resume button\n        await waitFor(RESUME_BUTTON);\n      });\n    });\n\n    it(`shows exactly one breakpoint ${withOrWithout}`, async () => {\n      const {frontend} = getBrowserAndPages();\n      await waitForSourceFiles(\n          SourceFileEvents.SourceFileLoaded, files => files.some(f => f.endsWith('multi-workers.js')), async () => {\n            // Have the target load the page.\n            await goToResource(targetPage);\n\n            await click('#tab-sources');\n            // Wait for all workers to load\n            await validateNavigationTree();\n            // Open file from second worker\n            await openNestedWorkerFile(workerFileSelectors(2));\n          });\n      // Set a breakpoint\n      await addBreakpointForLine(frontend, 6);\n\n      await waitFor('.breakpoint-entry');\n      const breakpoints = (await $$('.breakpoint-entry')).length;\n      assert.strictEqual(breakpoints, 1);\n    });\n\n    describe(`copies breakpoints between workers ${withOrWithout}`, () => {\n      beforeEach(async () => {\n        const {frontend} = getBrowserAndPages();\n        await waitForSourceFiles(\n            SourceFileEvents.SourceFileLoaded, files => files.some(f => f.endsWith('multi-workers.js')), async () => {\n              // Have the target load the page.\n              await goToResource(targetPage);\n\n              await click('#tab-sources');\n              // Wait for all workers to load\n              await validateNavigationTree();\n\n              await step('Open file from second worker', async () => {\n                await openNestedWorkerFile(workerFileSelectors(2));\n              });\n            });\n\n        await step('Set two breakpoints', async () => {\n          await addBreakpointForLine(frontend, 6);\n        });\n\n        await step('Disable first breakpoint', async () => {\n          const bpEntry = await waitFor('.breakpoint-entry');\n          const bpCheckbox = await waitFor('input', bpEntry);\n          await bpCheckbox.evaluate(n => (n as HTMLElement).click());\n          await waitFor('.cm-breakpoint-disabled');\n        });\n\n        await step('Add another breakpoint', async () => {\n          await addBreakpointForLine(frontend, 12);\n        });\n\n        await step('Check breakpoints', async () => {\n          await validateBreakpoints();\n        });\n\n        await step('Close tab', async () => {\n          await click('[aria-label=\"Close multi-workers.js\"]');\n        });\n      });\n\n      it('when opening different file in editor', async () => {\n        // Open different worker\n        await step('Open different worker', async () => {\n          await openNestedWorkerFile(workerFileSelectors(3));\n        });\n\n        await step('Check breakpoints', async () => {\n          await validateBreakpoints();\n        });\n      });\n\n      it('after reloading', async () => {\n        const {target} = getBrowserAndPages();\n\n        await step('Reload page', async () => {\n          await target.reload();\n        });\n\n        // FIXME(crbug/1112692): Refactor test to remove the timeout.\n        await timeout(100);\n\n        await step('Open different worker', async () => {\n          await openNestedWorkerFile(workerFileSelectors(4));\n        });\n\n        await step('Check breakpoints', async () => {\n          await waitFor('.cm-breakpoint');\n          await validateBreakpoints();\n        });\n      });\n    });\n\n    describe(`hits breakpoints added to workers ${withOrWithout}`, () => {\n      beforeEach(async () => {\n        const {frontend} = getBrowserAndPages();\n        await waitForSourceFiles(\n            SourceFileEvents.SourceFileLoaded, files => files.some(f => f.endsWith('multi-workers.js')), async () => {\n              // Have the target load the page.\n              await goToResource(targetPage);\n\n              await step('Open sources panel', async () => {\n                await click('#tab-sources');\n              });\n\n              await validateNavigationTree();\n\n              await step('Open second worker file', async () => {\n                await openNestedWorkerFile(workerFileSelectors(2));\n              });\n            });\n\n        await step('Set breakpoint', async () => {\n          await addBreakpointForLine(frontend, 6);\n        });\n      });\n\n      it('for pre-loaded workers', async () => {\n        const {target} = getBrowserAndPages();\n        // Send message to a worker to trigger break\n        await target.evaluate('workers[5].postMessage({});');\n\n        // Validate that we are paused by locating the resume button\n        await waitFor(RESUME_BUTTON);\n\n        // Validate that the code has paused on the breakpoint at the correct script location\n        assert.deepEqual(await retrieveTopCallFrameWithoutResuming(), 'multi-workers.js:6');\n\n        // Look at source tabs\n        await validateSourceTabs();\n      });\n\n      it('for newly created workers', async () => {\n        const {target} = getBrowserAndPages();\n        // Launch new worker to hit breakpoint\n        await target.evaluate(`new Worker('${scriptFile}').postMessage({});`);\n\n        // Validate that we are paused by locating the resume button\n        await waitFor(RESUME_BUTTON);\n\n        // Validate that the code has paused on the breakpoint at the correct script location\n        assert.deepEqual(await retrieveTopCallFrameWithoutResuming(), 'multi-workers.js:6');\n\n        await validateSourceTabs();\n      });\n    });\n  });\n});\n"]}