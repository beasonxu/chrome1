{"version":3,"file":"cookie-domain-attribute-non-ascii_test.js","sourceRoot":"","sources":["../../../../../../../../../third_party/devtools-frontend/src/test/e2e/issues/cookie-domain-attribute-non-ascii_test.ts"],"names":[],"mappings":";AAAA,4DAA4D;AAC5D,yEAAyE;AACzE,6BAA6B;;AAE7B,sDAAkG;AAClG,0EAA8D;AAC9D,oEAOsC;AAEtC,IAAA,8BAAQ,EAAC,uEAAuE,EAAE,KAAK,IAAI,EAAE;IAC3F,SAAS,CAAC,KAAK,IAAI,EAAE;QACnB,MAAM,EAAC,MAAM,EAAC,GAAG,IAAA,8BAAkB,GAAE,CAAC;QACtC,MAAM,OAAO,GAAG,MAAM,MAAM,CAAC,OAAO,EAAE,CAAC;QACvC,MAAM,MAAM,CAAC,YAAY,CAAC,GAAG,OAAO,CAAC,CAAC;IACxC,CAAC,CAAC,CAAC;IAEH,IAAA,wBAAE,EAAC,wFAAwF,EAAE,KAAK,IAAI,EAAE;QACtG,MAAM,IAAA,uCAAmB,GAAE,CAAC;QAC5B,MAAM,IAAA,wBAAY,EAAC,YAAY,CAAC,CAAC;QACjC,MAAM,EAAC,MAAM,EAAC,GAAG,IAAA,8BAAkB,GAAE,CAAC;QAEtC,MAAM,MAAM,CAAC,QAAQ,CAAC,KAAK,IAAI,EAAE;YAC/B,MAAM,GAAG,GAAG,QAAQ,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YAC1C,MAAM,IAAI,GAAG,IAAI,OAAO,CAAC,CAAC,CAAC,EAAE;gBAC3B,GAAG,CAAC,OAAO,GAAG,CAAC,CAAC;YAClB,CAAC,CAAC,CAAC;YACH,GAAG,CAAC,GAAG,GAAG,8CAA8C,CAAC;YACzD,QAAQ,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC;YAC/B,MAAM,IAAI,CAAC;QACb,CAAC,CAAC,CAAC;QAEH,MAAM,IAAA,uCAAmB,GAAE,CAAC;QAC5B,MAAM,IAAA,+BAAW,GAAE,CAAC;QACpB,MAAM,YAAY,GAAG,MAAM,IAAA,mCAAe,EAAC,uEAAuE,CAAC,CAAC;QACpH,IAAA,oCAAwB,EAAC,YAAY,CAAC,CAAC;QACvC,MAAM,OAAO,GAAG,MAAM,IAAA,uCAAmB,EAAC,yBAAyB,EAAE,YAAY,EAAE,0BAA0B,CAAC,CAAC;QAC/G,MAAM,IAAA,mDAA+B,EAAC,OAAO,CAAC,CAAC;QAC/C,MAAM,iBAAiB,GAAG;YACxB,CAAC,sCAAsC,CAAC;SACzC,CAAC;QACF,MAAM,IAAA,2DAAuC,EAAC,OAAO,CAAC,OAAO,EAAE,iBAAiB,CAAC,CAAC;IACpF,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","sourcesContent":["// Copyright 2022 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assertNotNullOrUndefined, getBrowserAndPages, goToResource} from '../../shared/helper.js';\nimport {describe, it} from '../../shared/mocha-extensions.js';\nimport {\n  ensureResourceSectionIsExpanded,\n  expandIssue,\n  getIssueByTitle,\n  getResourcesElement,\n  navigateToIssuesTab,\n  waitForTableFromResourceSectionContents,\n} from '../helpers/issues-helpers.js';\n\ndescribe('Cookie domain attribute should not contain non-ASCII characters issue', async () => {\n  afterEach(async () => {\n    const {target} = getBrowserAndPages();\n    const cookies = await target.cookies();\n    await target.deleteCookie(...cookies);\n  });\n\n  it('should display an issue when a cookie has a domain attribute with non-ASCII characters', async () => {\n    await navigateToIssuesTab();\n    await goToResource('empty.html');\n    const {target} = getBrowserAndPages();\n\n    await target.evaluate(async () => {\n      const img = document.createElement('img');\n      const done = new Promise(c => {\n        img.onerror = c;\n      });\n      img.src = './issues/cookie-domain-non-ascii.rawresponse';\n      document.body.appendChild(img);\n      await done;\n    });\n\n    await navigateToIssuesTab();\n    await expandIssue();\n    const issueElement = await getIssueByTitle('Ensure cookie `Domain` attribute values only contain ASCII characters');\n    assertNotNullOrUndefined(issueElement);\n    const section = await getResourcesElement('1 Raw Set-Cookie header', issueElement, '.affected-resource-label');\n    await ensureResourceSectionIsExpanded(section);\n    const expectedTableRows = [\n      ['tasty_cookie=yum; Domain=Ã¶xample.com'],\n    ];\n    await waitForTableFromResourceSectionContents(section.content, expectedTableRows);\n  });\n});\n"]}