{"version":3,"file":"console-context-selector_test.js","sourceRoot":"","sources":["../../../../../../../../../third_party/devtools-frontend/src/test/e2e/console/console-context-selector_test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2022 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assert} from 'chai';\n\nimport {\n  $textContent,\n  assertNotNullOrUndefined,\n  click,\n  getBrowserAndPages,\n  goToResource,\n  hasClass,\n  pressKey,\n  step,\n  waitFor,\n  waitForFunction,\n  waitForMany,\n} from '../../shared/helper.js';\nimport {describe, it} from '../../shared/mocha-extensions.js';\nimport {navigateToConsoleTab} from '../helpers/console-helpers.js';\nimport {openSourcesPanel, RESUME_BUTTON} from '../helpers/sources-helpers.js';\n\ndescribe('The Console Tab', async () => {\n  it('context selector', async () => {\n    await goToResource('console/context-selector.html');\n    await navigateToConsoleTab();\n    const {target} = getBrowserAndPages();\n    await target.evaluate('setup()');\n    let contextSelectorButton = await waitFor('[aria-label=\"JavaScript context: top\"]');\n\n    async function waitForMenuItemWithText(text: string) {\n      const result = await waitForFunction(async () => {\n        for (const menuItem of await waitForMany('[role=menuitem]', 1)) {\n          if (await $textContent(text, menuItem)) {\n            return menuItem;\n          }\n        }\n        return null;\n      });\n      assertNotNullOrUndefined(result);\n      return result;\n    }\n\n    const FRAME_CONTEXT_LABEL = 'myframe (context-selector-inner.html)';\n\n    await step('switch to the iframe context', async () => {\n      await contextSelectorButton.press('Enter');\n      const frameMenuItem = await waitForMenuItemWithText(FRAME_CONTEXT_LABEL);\n      await click(frameMenuItem);\n      await pressKey('Enter');\n      contextSelectorButton = await waitFor(`[aria-label=\"JavaScript context: ${FRAME_CONTEXT_LABEL}\"]`);\n    });\n\n    await step('pause in main frame', async () => {\n      void target.evaluate('pauseInMain()');\n      await waitFor('#tab-sources[aria-selected=\"true\"]');\n      await navigateToConsoleTab();\n      contextSelectorButton = await waitFor('[aria-label=\"JavaScript context: top\"]');\n      await contextSelectorButton.press('Enter');\n      assert.isTrue(await hasClass(await waitForMenuItemWithText(FRAME_CONTEXT_LABEL), 'disabled'));\n      await pressKey('Escape');\n    });\n\n    await step('resume in main frame', async () => {\n      await openSourcesPanel();\n      await click(RESUME_BUTTON);\n      await navigateToConsoleTab();\n\n      contextSelectorButton = await waitFor('[aria-label=\"JavaScript context: top\"]');\n      await contextSelectorButton.press('Enter');\n      assert.isFalse(await hasClass(await waitForMenuItemWithText(FRAME_CONTEXT_LABEL), 'disabled'));\n      await pressKey('Escape');\n    });\n\n    const WORKER_CONTEXT_LABEL = 'âš™ worker-pause.js';\n    await step('pause in worker', async () => {\n      void target.evaluate('pauseInWorker()');\n      await waitFor('#tab-sources[aria-selected=\"true\"]');\n      await navigateToConsoleTab();\n\n      contextSelectorButton = await waitFor(`[aria-label=\"JavaScript context: ${WORKER_CONTEXT_LABEL}\"]`);\n      await contextSelectorButton.press('Enter');\n      assert.isFalse(await hasClass((await waitForMenuItemWithText('top')), 'disabled'));\n      assert.isFalse(await hasClass((await waitForMenuItemWithText(FRAME_CONTEXT_LABEL)), 'disabled'));\n      await pressKey('Escape');\n    });\n\n    await step('resume in worker', async () => {\n      await openSourcesPanel();\n      await click(RESUME_BUTTON);\n      await navigateToConsoleTab();\n\n      contextSelectorButton = await waitFor(`[aria-label=\"JavaScript context: ${WORKER_CONTEXT_LABEL}\"]`);\n    });\n\n    await step('pause in the iframe', async () => {\n      void target.evaluate('pauseInIframe()');\n      await waitFor('#tab-sources[aria-selected=\"true\"]');\n      await navigateToConsoleTab();\n\n      contextSelectorButton = await waitFor(`[aria-label=\"JavaScript context: ${FRAME_CONTEXT_LABEL}\"]`);\n      await contextSelectorButton.press('Enter');\n      assert.isTrue(await hasClass((await waitForMenuItemWithText('top')), 'disabled'));\n      await pressKey('Escape');\n    });\n\n    await step('resume in the iframe', async () => {\n      await openSourcesPanel();\n      await click(RESUME_BUTTON);\n      await navigateToConsoleTab();\n\n      contextSelectorButton = await waitFor(`[aria-label=\"JavaScript context: ${FRAME_CONTEXT_LABEL}\"]`);\n      await contextSelectorButton.press('Enter');\n      assert.isFalse(await hasClass((await waitForMenuItemWithText('top')), 'disabled'));\n      await pressKey('Escape');\n    });\n  });\n});\n"]}