{"version":3,"file":"console-errors_test.js","sourceRoot":"","sources":["../../../../../../../../../third_party/devtools-frontend/src/test/e2e/console/console-errors_test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2021 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assert} from 'chai';\n\nimport {getTestServerPort, goToResource, waitForFunction} from '../../shared/helper.js';\nimport {describe, it} from '../../shared/mocha-extensions.js';\nimport {\n  getStructuredConsoleMessages,\n  navigateToConsoleTab,\n  showVerboseMessages,\n  waitForConsoleMessagesToBeNonEmpty,\n} from '../helpers/console-helpers.js';\n\n/* eslint-disable no-console */\n\ndescribe('The Console\\'s errors', () => {\n  it('picks up custom exception names ending with \\'Error\\' and symbolizes stack traces according to source maps',\n     async () => {\n       await goToResource('sources/error-with-sourcemap.html');\n       await navigateToConsoleTab();\n       await showVerboseMessages();\n       await waitForFunction(async () => {\n         const messages = await getStructuredConsoleMessages();\n         if (messages.length !== 1) {\n           return false;\n         }\n         const [{message}] = messages;\n         return /^MyError.*error-with-sourcemap.ts:6/.test(message.replace('\\n', ''));\n       });\n     });\n\n  it('correctly symbolizes stack traces with async frames for anonymous functions', async () => {\n    await goToResource('console/error-with-async-frame.html');\n    await navigateToConsoleTab();\n    await showVerboseMessages();\n    await waitForFunction(async () => {\n      const messages = await getStructuredConsoleMessages();\n      if (messages.length !== 1) {\n        return false;\n      }\n      const [{message}] = messages;\n      return message === `Error\n    at foo (async.js:2:46)\n    at async async.js:3:21`;\n    });\n  });\n\n  it('shows errors to load a resource', async () => {\n    await goToResource('console/resource-errors.html');\n    await navigateToConsoleTab();\n    await showVerboseMessages();\n    await waitForConsoleMessagesToBeNonEmpty(5);\n    const messages = await getStructuredConsoleMessages();\n    messages.sort((m1, m2) => m1.message.localeCompare(m2.message));\n    assert.deepEqual(messages, [\n      {\n        message:\n            `GET https://localhost:${getTestServerPort()}/test/e2e/resources/console/non-existent-xhr 404 (Not Found)`,\n        messageClasses: 'console-message',\n        repeatCount: null,\n        source: 'resource-errors.html:20',\n        stackPreview: `\nloadXHR @ resource-errors.html:20\nstep2 @ resource-errors.html:12\nerror (async)\nperformActions @ resource-errors.html:7\n(anonymous) @ resource-errors.html:30`,\n        wrapperClasses: 'console-message-wrapper console-error-level',\n      },\n      {\n        message: `GET https://localhost:${\n            getTestServerPort()}/test/e2e/resources/missing.css net::ERR_ABORTED 404 (Not Found)`,\n        messageClasses: 'console-message',\n        repeatCount: null,\n        source: 'resource-errors-iframe.html:3',\n        stackPreview: null,\n        wrapperClasses: 'console-message-wrapper console-error-level',\n      },\n      {\n        message:\n            `GET https://localhost:${getTestServerPort()}/test/e2e/resources/non-existent-iframe.html 404 (Not Found)`,\n        messageClasses: 'console-message',\n        repeatCount: null,\n        source: 'resource-errors-iframe.html:8',\n        stackPreview: null,\n        wrapperClasses: 'console-message-wrapper console-error-level',\n      },\n      {\n        message: `GET https://localhost:${\n            getTestServerPort()}/test/e2e/resources/non-existent-script.js net::ERR_ABORTED 404 (Not Found)`,\n        messageClasses: 'console-message',\n        repeatCount: null,\n        source: 'resource-errors-iframe.html:4',\n        stackPreview: null,\n        wrapperClasses: 'console-message-wrapper console-error-level',\n      },\n      {\n        message: 'GET unknown-scheme://foo net::ERR_UNKNOWN_URL_SCHEME',\n        messageClasses: 'console-message',\n        repeatCount: null,\n        source: 'unknown-scheme://foo:1',\n        stackPreview: `\nImage (async)\nperformActions @ resource-errors.html:8\n(anonymous) @ resource-errors.html:30`,\n        wrapperClasses: 'console-message-wrapper console-error-level',\n      },\n    ]);\n  });\n});\n"]}