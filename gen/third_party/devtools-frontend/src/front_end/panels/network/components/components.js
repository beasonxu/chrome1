import*as e from"../../../core/common/common.js";import*as t from"../../../core/host/host.js";import*as r from"../../../core/i18n/i18n.js";import*as s from"../../../core/platform/platform.js";import*as o from"../../../core/root/root.js";import*as i from"../../../core/sdk/sdk.js";import*as a from"../../../models/issues_manager/issues_manager.js";import*as n from"../../../models/persistence/persistence.js";import*as d from"../../../models/workspace/workspace.js";import*as l from"../forward/forward.js";import*as c from"../../../third_party/chromium/client-variations/client-variations.js";import*as h from"../../../ui/components/buttons/buttons.js";import*as u from"../../../ui/components/helpers/helpers.js";import*as p from"../../../ui/components/icon_button/icon_button.js";import*as m from"../../../ui/components/input/input.js";import*as g from"../../../ui/legacy/legacy.js";import*as v from"../../../ui/lit-html/lit-html.js";import*as w from"../../sources/sources.js";import*as f from"../../../ui/components/report_view/report_view.js";const R=new CSSStyleSheet;R.replaceSync('devtools-request-headers-category{--override-header-highlight-background-color:#ffff78}.-theme-with-dark-background devtools-request-headers-category,:host-context(.-theme-with-dark-background) devtools-request-headers-category{--override-header-highlight-background-color:#4c4c33}.header{background-color:var(--color-background-elevation-1);border-bottom:var(--legacy-divider-border);border-top:var(--legacy-divider-border);line-height:25px;padding:0 5px}.header::marker{color:rgb(110 110 110);font-size:11px;line-height:1}.header:focus{background-color:var(--legacy-focus-bg-color)}details[open] .header-count{display:none}details .hide-when-closed{display:none}details[open] .hide-when-closed{display:block}details summary input{vertical-align:middle}.row{display:flex;line-height:20px;padding-left:8px;gap:12px;user-select:text}div.raw-headers-row{display:block}.row:first-of-type{margin-top:2px}.row:last-child{margin-bottom:10px}.header-name{color:var(--color-primary);font-weight:500;width:160px;flex-shrink:0;text-transform:capitalize}.header-value{word-break:break-all}.green-circle::before,.red-circle::before,.yellow-circle::before{content:"";display:inline-block;width:12px;height:12px;border-radius:6px;vertical-align:text-top;margin-right:2px}.green-circle::before{background-color:var(--color-accent-green)}.red-circle::before{background-color:var(--color-accent-red)}.yellow-circle::before{background-color:var(--issue-color-yellow)}.status-with-comment{color:var(--color-text-secondary)}.raw-headers{font-family:var(--source-code-font-family);font-size:var(--source-code-font-size);white-space:pre-wrap;word-break:break-all}.header-badge-text{font-variant:small-caps;font-weight:500;white-space:pre-wrap;word-break:break-all}.header-badge{display:inline;margin-right:.75em;background-color:var(--color-accent-red);color:var(--color-background);border-radius:100vh;padding-left:6px;padding-right:6px}.call-to-action{background-color:var(--color-background-elevation-1);padding:8px;border-radius:2px}.call-to-action-body{padding:6px 0;margin-left:9.5px;border-left:2px solid var(--issue-color-yellow);padding-left:18px;line-height:20px}.call-to-action .explanation{font-weight:700}.call-to-action code{font-size:90%}.call-to-action .example .comment::before{content:" — "}.devtools-link,.link{color:var(--color-link);text-decoration:underline;cursor:pointer;padding:2px 0}.explanation .link{font-weight:400}.inline-icon{vertical-align:middle}.header-value code{display:block;white-space:pre-wrap;font-size:90%;color:var(--color-text-secondary)}.header-grid-container{display:inline-grid;grid-template-columns:156px 50px 1fr;grid-gap:4px;width:calc(100% - 15px)}.header-grid-container div:last-child{text-align:right}.header .devtools-link{color:var(--color-text-primary)}x-link .inline-icon{padding-right:3px}.purple-dot{filter:hue-rotate(160deg)}.-theme-with-dark-background .purple-dot,:host-context(.-theme-with-dark-background) .purple-dot{filter:invert(80%) hue-rotate(350deg)}summary label{color:var(--color-text-secondary)}summary label:hover{color:var(--color-text-primary)}.header-highlight{background-color:var(--override-header-highlight-background-color)}\n/*# sourceURL=RequestHeadersView.css */\n');const{render:k,html:T}=v,y={activeClientExperimentVariation:"Active `client experiment variation IDs`.",activeClientExperimentVariationIds:"Active `client experiment variation IDs` that trigger server-side behavior.",chooseThisOptionIfTheResourceAnd:"Choose this option if the resource and the document are served from the same site.",decoded:"Decoded:",fromDiskCache:"(from disk cache)",fromMemoryCache:"(from memory cache)",fromPrefetchCache:"(from prefetch cache)",fromServiceWorker:"(from `service worker`)",fromSignedexchange:"(from signed-exchange)",fromWebBundle:"(from Web Bundle)",general:"General",headerOverrides:"Header overrides",learnMore:"Learn more",learnMoreInTheIssuesTab:"Learn more in the issues tab",raw:"Raw",onlyChooseThisOptionIfAn:"Only choose this option if an arbitrary website including this resource does not impose a security risk.",provisionalHeadersAreShownDisableCache:"Provisional headers are shown. Disable cache to see full headers.",onlyProvisionalHeadersAre:"Only provisional headers are available because this request was not sent over the network and instead was served from a local cache, which doesn’t store the original request headers. Disable cache to see full request headers.",provisionalHeadersAreShown:"Provisional headers are shown.",referrerPolicy:"Referrer Policy",remoteAddress:"Remote Address",requestHeaders:"Request Headers",requestMethod:"Request Method",requestUrl:"Request URL",responseHeaders:"Response Headers",showMore:"Show more",statusCode:"Status Code",thisDocumentWasBlockedFrom:"This document was blocked from loading in an `iframe` with a `sandbox` attribute because this document specified a cross-origin opener policy.",toEmbedThisFrameInYourDocument:"To embed this frame in your document, the response needs to enable the cross-origin embedder policy by specifying the following response header:",toUseThisResourceFromADifferent:"To use this resource from a different origin, the server needs to specify a cross-origin resource policy in the response headers:",toUseThisResourceFromADifferentOrigin:"To use this resource from a different origin, the server may relax the cross-origin resource policy response header:",toUseThisResourceFromADifferentSite:"To use this resource from a different site, the server may relax the cross-origin resource policy response header:"},x=r.i18n.registerUIStrings("panels/network/components/RequestHeadersView.ts",y),$=r.i18n.getLocalizedString.bind(void 0,x),b=r.i18n.getLazilyComputedLocalizedString.bind(void 0,x);class q extends g.Widget.VBox{#e=new S;#t;constructor(e){super(),this.#t=e,this.contentElement.appendChild(this.#e)}wasShown(){this.#t.addEventListener(i.NetworkRequest.Events.RemoteAddressChanged,this.#r,this),this.#t.addEventListener(i.NetworkRequest.Events.FinishedLoading,this.#r,this),this.#t.addEventListener(i.NetworkRequest.Events.RequestHeadersChanged,this.#r,this),this.#t.addEventListener(i.NetworkRequest.Events.ResponseHeadersChanged,this.#r,this),this.#r()}willHide(){this.#t.removeEventListener(i.NetworkRequest.Events.RemoteAddressChanged,this.#r,this),this.#t.removeEventListener(i.NetworkRequest.Events.FinishedLoading,this.#r,this),this.#t.removeEventListener(i.NetworkRequest.Events.RequestHeadersChanged,this.#r,this),this.#t.removeEventListener(i.NetworkRequest.Events.ResponseHeadersChanged,this.#r,this)}#r(){this.#e.data={request:this.#t}}revealHeader(e,t){this.#e.data={request:this.#t,toReveal:{section:e,header:t}}}}class S extends HTMLElement{static litTagName=v.literal`devtools-request-headers`;#s=this.attachShadow({mode:"open"});#t;#o=!1;#i=!1;#a=!1;#n=!1;#d=void 0;#l=d.Workspace.WorkspaceImpl.instance();set data(e){this.#t=e.request,this.#d=e.toReveal,this.#c()}connectedCallback(){this.#s.adoptedStyleSheets=[R],this.#l.addEventListener(d.Workspace.Events.UISourceCodeAdded,this.#h,this),this.#l.addEventListener(d.Workspace.Events.UISourceCodeRemoved,this.#h,this)}disconnectedCallback(){this.#l.removeEventListener(d.Workspace.Events.UISourceCodeAdded,this.#h,this),this.#l.removeEventListener(d.Workspace.Events.UISourceCodeRemoved,this.#h,this)}#h(e){this.#u()===e.data.url()&&this.#c()}#c(){this.#t&&k(T` ${this.#p()} ${this.#m()} ${this.#g()} `,this.#s,{host:this})}#m(){if(!this.#t)return v.nothing;const e=[];if(this.#t.wasBlocked()){const t=H.get(this.#t.blockedReason());t&&e.push(t)}const t=function(e,t){let r=0,s=0;const o=[];for(;r<e.length&&s<t.length;)e[r].name<t[s].name?o.push({...e[r++],headerNotSet:!1}):e[r].name>t[s].name?o.push({...t[s++],headerNotSet:!0}):o.push({...t[s++],...e[r++],headerNotSet:!1});for(;r<e.length;)o.push({...e[r++],headerNotSet:!1});for(;s<t.length;)o.push({...t[s++],headerNotSet:!0});return o}(this.#t.sortedResponseHeaders.slice(),e),r=this.#t.blockedResponseCookies(),s=new Map(r?.map((e=>[e.cookieLine,e.blockedReasons])));for(const e of t)if("set-cookie"===e.name.toLowerCase()&&e.value){const t=s.get(e.value.toString());t&&(e.setCookieBlockedReasons=t)}return t.length?T` <${I.litTagName} @togglerawevent="${()=>{this.#o=!this.#o,this.#c()}}" .data="${{name:"responseHeaders",title:$(y.responseHeaders),headerCount:this.#t.sortedResponseHeaders.length,checked:this.#t.responseHeadersText?this.#o:void 0,additionalContent:this.#v(),forceOpen:this.#d?.section===l.UIRequestLocation.UIHeaderSection.Response}}" aria-label="${$(y.responseHeaders)}"> ${this.#o?this.#w(this.#t.responseHeadersText,!0):T` ${t.map((e=>this.#f(e,l.UIRequestLocation.UIHeaderSection.Response)))} `} </${I.litTagName}> `:v.nothing}#v(){if(!o.Runtime.experiments.isEnabled(o.Runtime.ExperimentName.HEADER_OVERRIDES)||!this.#l.uiSourceCodeForURL(this.#u()))return v.nothing;const t=e.Settings.Settings.instance().moduleSetting("persistenceNetworkOverridesEnabled").get()?T` <${p.Icon.Icon.litTagName} class="inline-icon purple-dot" .data="${{iconName:"file-sync_icon",width:"11px",height:"13px"}}"> </${p.Icon.Icon.litTagName}>`:T` <${p.Icon.Icon.litTagName} class="inline-icon" .data="${{iconName:"file_icon",color:"var(--color-text-primary)",width:"12px",height:"12px"}}"> </${p.Icon.Icon.litTagName}>`;return T` <x-link @click="${e=>{e.preventDefault();const t=this.#l.uiSourceCodeForURL(this.#u());t&&w.SourcesPanel.SourcesPanel.instance().showUISourceCode(t)}}" class="link devtools-link"> ${t}${$(y.headerOverrides)} </x-link> `}#u(){if(!this.#t)return s.DevToolsPath.EmptyUrlString;const e=n.NetworkPersistenceManager.NetworkPersistenceManager.instance().fileUrlFromNetworkUrl(this.#t.url(),!0);return e.substring(0,e.lastIndexOf("/"))+"/"+n.NetworkPersistenceManager.HEADERS_FILENAME}#g(){if(!this.#t)return v.nothing;const e=this.#t.requestHeaders().slice();e.sort((function(e,t){return s.StringUtilities.compare(e.name.toLowerCase(),t.name.toLowerCase())}));const t=this.#t.requestHeadersText();if(!e.length&&void 0!==t)return v.nothing;return T` <${I.litTagName} @togglerawevent="${()=>{this.#i=!this.#i,this.#c()}}" .data="${{name:"requestHeaders",title:$(y.requestHeaders),headerCount:this.#t.requestHeaders().length,checked:t?this.#i:void 0,forceOpen:this.#d?.section===l.UIRequestLocation.UIHeaderSection.Request}}" aria-label="${$(y.requestHeaders)}"> ${this.#i&&t?this.#w(t,!1):T` ${this.#R()} ${e.map((e=>this.#f({...e,headerNotSet:!1},l.UIRequestLocation.UIHeaderSection.Request)))} `} </${I.litTagName}> `}#R(){if(!this.#t||void 0!==this.#t.requestHeadersText())return v.nothing;let e,t="";return this.#t.cachedInMemory()||this.#t.cached()?(e=$(y.provisionalHeadersAreShownDisableCache),t=$(y.onlyProvisionalHeadersAre)):e=$(y.provisionalHeadersAreShown),T` <div class="call-to-action"> <div class="call-to-action-body"> <div class="explanation" title="${t}"> <${p.Icon.Icon.litTagName} class="inline-icon" .data="${{iconName:"clear-warning_icon",width:"12px",height:"12px"}}"> </${p.Icon.Icon.litTagName}> ${e} <x-link href="https://developer.chrome.com/docs/devtools/network/reference/#provisional-headers" class="link">${$(y.learnMore)}</x-link> </div> </div> </div> `}#f(e,s){const o=s===this.#d?.section&&e.name.toUpperCase()===this.#d?.header?.toUpperCase();return T` <div class="row ${o?"header-highlight":""}"> <div class="header-name"> ${e.headerNotSet?T`<div class="header-badge header-badge-text">${r.i18n.lockedString("not-set")}</div>`:v.nothing}${e.name}: </div> <div class="header-value ${e.headerValueIncorrect?"header-warning":""}" @copy="${()=>t.userMetrics.actionTaken(t.UserMetrics.Action.NetworkPanelCopyValue)}"> ${e.value?.toString()||""} ${this.#k(e)} </div> </div> ${this.#T(e.blockedDetails)} `}#k(e){const t=e.name.toLowerCase();if("set-cookie"===t&&e.setCookieBlockedReasons){const t=e.setCookieBlockedReasons.map(i.NetworkRequest.setCookieBlockedReasonToUiString).join("\n");return T` <${p.Icon.Icon.litTagName} class="inline-icon" title="${t}" .data="${{iconName:"clear-warning_icon",width:"12px",height:"12px"}}"> </${p.Icon.Icon.litTagName}> `}if("x-client-data"===t){const t=c.parseClientVariations(e.value?.toString()||""),r=c.formatClientVariations(t,$(y.activeClientExperimentVariation),$(y.activeClientExperimentVariationIds));return T` <div>${$(y.decoded)}</div> <code>${r}</code> `}return v.nothing}#T(e){return e?T` <div class="call-to-action"> <div class="call-to-action-body"> <div class="explanation">${e.explanation()}</div> ${e.examples.map((e=>T` <div class="example"> <code>${e.codeSnippet}</code> ${e.comment?T` <span class="comment">${e.comment()}</span> `:""} </div> `))} ${this.#y(e)} </div> </div> `:v.nothing}#y(e){if(this.#t&&a.RelatedIssue.hasIssueOfCategory(this.#t,a.Issue.IssueCategory.CrossOriginEmbedderPolicy)){return T` <div class="devtools-link" @click="${()=>{t.userMetrics.issuesPanelOpenedFrom(t.UserMetrics.IssueOpener.LearnMoreLinkCOEP),this.#t&&a.RelatedIssue.reveal(this.#t,a.Issue.IssueCategory.CrossOriginEmbedderPolicy)}}"> <${p.Icon.Icon.litTagName} class="inline-icon" .data="${{iconName:"issue-exclamation-icon",color:"var(--issue-color-yellow)",width:"16px",height:"16px"}}"> </${p.Icon.Icon.litTagName}> ${$(y.learnMoreInTheIssuesTab)} </div> `}return e?.link?T` <x-link href="${e.link.url}" class="link"> <${p.Icon.Icon.litTagName} class="inline-icon" .data="${{iconName:"link_icon",color:"var(--color-link)",width:"16px",height:"16px"}}"> </${p.Icon.Icon.litTagName}>${$(y.learnMore)} </x-link> `:v.nothing}#w(e,t){const r=e.trim(),s=!(t?this.#a:this.#n)&&r.length>3e3,o=()=>{t?this.#a=!0:this.#n=!0,this.#c()},i=e=>{if(!(t?this.#a:this.#n)){const t=new g.ContextMenu.ContextMenu(e);t.newSection().appendItem($(y.showMore),o),t.show()}};return T` <div class="row raw-headers-row" on-render="${u.Directives.nodeRenderedCallback((e=>{s&&e.addEventListener("contextmenu",i)}))}"> <div class="raw-headers">${s?r.substring(0,3e3):r}</div> ${s?T` <${h.Button.Button.litTagName} .size="${"SMALL"}" .variant="${"secondary"}" @click="${o}">${$(y.showMore)}</${h.Button.Button.litTagName}> `:v.nothing} </div> `}#p(){if(!this.#t)return v.nothing;const e=[];this.#t.statusCode<300||304===this.#t.statusCode?e.push("green-circle"):this.#t.statusCode<400?e.push("yellow-circle"):e.push("red-circle");let t=this.#t.statusCode+" "+this.#t.statusText;return this.#t.cachedInMemory()?(t+=" "+$(y.fromMemoryCache),e.push("status-with-comment")):this.#t.fetchedViaServiceWorker?(t+=" "+$(y.fromServiceWorker),e.push("status-with-comment")):this.#t.redirectSourceSignedExchangeInfoHasNoErrors()?(t+=" "+$(y.fromSignedexchange),e.push("status-with-comment")):this.#t.webBundleInnerRequestInfo()?(t+=" "+$(y.fromWebBundle),e.push("status-with-comment")):this.#t.fromPrefetchCache()?(t+=" "+$(y.fromPrefetchCache),e.push("status-with-comment")):this.#t.cached()&&(t+=" "+$(y.fromDiskCache),e.push("status-with-comment")),T` <${I.litTagName} .data="${{name:"general",title:$(y.general),forceOpen:this.#d?.section===l.UIRequestLocation.UIHeaderSection.General}}" aria-label="${$(y.general)}"> ${this.#x($(y.requestUrl),this.#t.url())} ${this.#t.statusCode?this.#x($(y.requestMethod),this.#t.requestMethod):v.nothing} ${this.#t.statusCode?this.#x($(y.statusCode),t,e):v.nothing} ${this.#t.remoteAddress()?this.#x($(y.remoteAddress),this.#t.remoteAddress()):v.nothing} ${this.#t.referrerPolicy()?this.#x($(y.referrerPolicy),String(this.#t.referrerPolicy())):v.nothing} </${I.litTagName}> `}#x(e,r,s){const o=this.#d?.section===l.UIRequestLocation.UIHeaderSection.General&&e.toUpperCase()===this.#d?.header?.toUpperCase();return T` <div class="row ${o?"header-highlight":""}"> <div class="header-name">${e}:</div> <div class="header-value ${s?.join(" ")}" @copy="${()=>t.userMetrics.actionTaken(t.UserMetrics.Action.NetworkPanelCopyValue)}">${r}</div> </div> `}}class C extends Event{static eventName="togglerawevent";constructor(){super(C.eventName,{})}}class I extends HTMLElement{static litTagName=v.literal`devtools-request-headers-category`;#s=this.attachShadow({mode:"open"});#$;#b=e.UIString.LocalizedEmptyString;#q=void 0;#S=void 0;#C=void 0;#I=void 0;connectedCallback(){this.#s.adoptedStyleSheets=[R,m.checkboxStyles]}set data(t){this.#b=t.title,this.#$=e.Settings.Settings.instance().createSetting("request-info-"+t.name+"-category-expanded",!0),this.#q=t.headerCount,this.#S=t.checked,this.#C=t.additionalContent,this.#I=t.forceOpen,this.#c()}#H(){this.dispatchEvent(new C)}#c(){const e=!this.#$||this.#$.get()||this.#I;k(T` <details ?open="${e}" @toggle="${this.#N}"> <summary class="header" @keydown="${this.#V}"> <div class="header-grid-container"> <div> ${this.#b}${this.#q?T`<span class="header-count"> (${this.#q})</span>`:v.nothing} </div> <div class="hide-when-closed"> ${void 0!==this.#S?T` <label><input type="checkbox" .checked="${this.#S}" @change="${this.#H}">${$(y.raw)}</label> `:v.nothing} </div> <div class="hide-when-closed">${this.#C}</div> </div></summary> <slot></slot> </details> `,this.#s,{host:this})}#V(e){if(!e.target)return;const t=e.target.parentElement;if(!t)throw new Error("<details> element is not found for a <summary> element");switch(e.key){case"ArrowLeft":t.open=!1;break;case"ArrowRight":t.open=!0}}#N(e){this.#$?.set(e.target.open)}}u.CustomElements.defineComponent("devtools-request-headers",S),u.CustomElements.defineComponent("devtools-request-headers-category",I);const H=new Map([["coep-frame-resource-needs-coep-header",{name:"cross-origin-embedder-policy",value:null,headerValueIncorrect:null,blockedDetails:{explanation:b(y.toEmbedThisFrameInYourDocument),examples:[{codeSnippet:"Cross-Origin-Embedder-Policy: require-corp",comment:void 0}],link:{url:"https://web.dev/coop-coep/"}},headerNotSet:null}],["corp-not-same-origin-after-defaulted-to-same-origin-by-coep",{name:"cross-origin-resource-policy",value:null,headerValueIncorrect:null,blockedDetails:{explanation:b(y.toUseThisResourceFromADifferent),examples:[{codeSnippet:"Cross-Origin-Resource-Policy: same-site",comment:b(y.chooseThisOptionIfTheResourceAnd)},{codeSnippet:"Cross-Origin-Resource-Policy: cross-origin",comment:b(y.onlyChooseThisOptionIfAn)}],link:{url:"https://web.dev/coop-coep/"}},headerNotSet:null}],["coop-sandboxed-iframe-cannot-navigate-to-coop-page",{name:"cross-origin-opener-policy",value:null,headerValueIncorrect:!1,blockedDetails:{explanation:b(y.thisDocumentWasBlockedFrom),examples:[],link:{url:"https://web.dev/coop-coep/"}},headerNotSet:null}],["corp-not-same-site",{name:"cross-origin-resource-policy",value:null,headerValueIncorrect:!0,blockedDetails:{explanation:b(y.toUseThisResourceFromADifferentSite),examples:[{codeSnippet:"Cross-Origin-Resource-Policy: cross-origin",comment:b(y.onlyChooseThisOptionIfAn)}],link:null},headerNotSet:null}],["corp-not-same-origin",{name:"cross-origin-resource-policy",value:null,headerValueIncorrect:!0,blockedDetails:{explanation:b(y.toUseThisResourceFromADifferentOrigin),examples:[{codeSnippet:"Cross-Origin-Resource-Policy: same-site",comment:b(y.chooseThisOptionIfTheResourceAnd)},{codeSnippet:"Cross-Origin-Resource-Policy: cross-origin",comment:b(y.onlyChooseThisOptionIfAn)}],link:null},headerNotSet:null}]]);var N=Object.freeze({__proto__:null,RequestHeadersView:q,RequestHeadersComponent:S,ToggleRawHeadersEvent:C,Category:I});const V=new CSSStyleSheet;V.replaceSync(".code{font-family:var(--monospace-font-family);font-size:var(--monospace-font-size)}.issuers-list{display:flex;flex-direction:column;list-style-type:none;padding:0;margin:0}.status-icon{margin:0 .3em 2px 0;vertical-align:middle}\n/*# sourceURL=RequestTrustTokensView.css */\n");const E={parameters:"Parameters",type:"Type",refreshPolicy:"Refresh policy",issuers:"Issuers",topLevelOrigin:"Top level origin",issuer:"Issuer",result:"Result",status:"Status",numberOfIssuedTokens:"Number of issued tokens",success:"Success",failure:"Failure",theOperationsResultWasServedFrom:"The operations result was served from cache.",theOperationWasFulfilledLocally:"The operation was fulfilled locally, no request was sent.",aClientprovidedArgumentWas:"A client-provided argument was malformed or otherwise invalid.",eitherNoInputsForThisOperation:"Either no inputs for this operation are available or the output exceeds the operations quota.",theServersResponseWasMalformedOr:"The servers response was malformed or otherwise invalid.",theOperationFailedForAnUnknown:"The operation failed for an unknown reason."},O=r.i18n.registerUIStrings("panels/network/components/RequestTrustTokensView.ts",E),L=r.i18n.getLocalizedString.bind(void 0,O);class D extends g.Widget.VBox{#E=new A;#t;constructor(e){super(),this.#t=e,this.contentElement.appendChild(this.#E)}wasShown(){this.#t.addEventListener(i.NetworkRequest.Events.TrustTokenResultAdded,this.#O,this),this.#O()}willHide(){this.#t.removeEventListener(i.NetworkRequest.Events.TrustTokenResultAdded,this.#O,this)}#O(){this.#E.data={params:this.#t.trustTokenParams(),result:this.#t.trustTokenOperationDoneEvent()}}}class A extends HTMLElement{static litTagName=v.literal`devtools-trust-token-report`;#s=this.attachShadow({mode:"open"});#L;set data(e){this.#L=e,this.#c()}connectedCallback(){this.#s.adoptedStyleSheets=[V]}#c(){if(!this.#L)throw new Error("Trying to render a Trust Token report without providing data");v.render(v.html`<${f.ReportView.Report.litTagName}> ${this.#D()} ${this.#A()} </${f.ReportView.Report.litTagName}> `,this.#s,{host:this})}#D(){return this.#L&&this.#L.params?v.html` <${f.ReportView.ReportSectionHeader.litTagName}>${L(E.parameters)}</${f.ReportView.ReportSectionHeader.litTagName}> ${W(L(E.type),this.#L.params.type.toString())} ${this.#U(this.#L.params)} ${this.#F(this.#L.params)} ${this.#P()} <${f.ReportView.ReportSectionDivider.litTagName}></${f.ReportView.ReportSectionDivider.litTagName}> `:v.nothing}#U(e){return"Redemption"!==e.type?v.nothing:W(L(E.refreshPolicy),e.refreshPolicy.toString())}#F(e){return e.issuers&&0!==e.issuers.length?v.html` <${f.ReportView.ReportKey.litTagName}>${L(E.issuers)}</${f.ReportView.ReportKey.litTagName}> <${f.ReportView.ReportValue.litTagName}> <ul class="issuers-list"> ${e.issuers.map((e=>v.html`<li>${e}`))} </ul> </${f.ReportView.ReportValue.litTagName}> `:v.nothing}#P(){return this.#L&&this.#L.result?v.html` ${M(L(E.topLevelOrigin),this.#L.result.topLevelOrigin)} ${M(L(E.issuer),this.#L.result.issuerOrigin)}`:v.nothing}#A(){return this.#L&&this.#L.result?v.html` <${f.ReportView.ReportSectionHeader.litTagName}>${L(E.result)}</${f.ReportView.ReportSectionHeader.litTagName}> <${f.ReportView.ReportKey.litTagName}>${L(E.status)}</${f.ReportView.ReportKey.litTagName}> <${f.ReportView.ReportValue.litTagName}> <span> <${p.Icon.Icon.litTagName} class="status-icon" .data="${e=this.#L.result.status,P(e)?U:F}"> </${p.Icon.Icon.litTagName}> <strong>${function(e){return P(e)?L(E.success):L(E.failure)}(this.#L.result.status)}</strong> ${function(e){switch(e){case"Ok":return null;case"AlreadyExists":return L(E.theOperationsResultWasServedFrom);case"FulfilledLocally":return L(E.theOperationWasFulfilledLocally);case"InvalidArgument":return L(E.aClientprovidedArgumentWas);case"ResourceExhausted":return L(E.eitherNoInputsForThisOperation);case"BadResponse":return L(E.theServersResponseWasMalformedOr);case"FailedPrecondition":case"Unavailable":case"InternalError":case"UnknownError":return L(E.theOperationFailedForAnUnknown)}}(this.#L.result.status)} </span> </${f.ReportView.ReportValue.litTagName}> ${this.#M(this.#L.result)} <${f.ReportView.ReportSectionDivider.litTagName}></${f.ReportView.ReportSectionDivider.litTagName}> `:v.nothing;var e}#M(e){return"Issuance"!==e.type?v.nothing:M(L(E.numberOfIssuedTokens),e.issuedTokenCount)}}const U={color:"rgb(12, 164, 12)",iconName:"ic_checkmark_16x16",width:"12px"},F={color:"",iconName:"error_icon",width:"12px"};function P(e){return"Ok"===e||"AlreadyExists"===e||"FulfilledLocally"===e}function M(e,t){return void 0===t?v.nothing:v.html` <${f.ReportView.ReportKey.litTagName}>${e}</${f.ReportView.ReportKey.litTagName}> <${f.ReportView.ReportValue.litTagName}>${t}</${f.ReportView.ReportValue.litTagName}> `}function W(e,t){return v.html` <${f.ReportView.ReportKey.litTagName}>${e}</${f.ReportView.ReportKey.litTagName}> <${f.ReportView.ReportValue.litTagName} class="code">${t}</${f.ReportView.ReportValue.litTagName}> `}u.CustomElements.defineComponent("devtools-trust-token-report",A);var _=Object.freeze({__proto__:null,RequestTrustTokensView:D,RequestTrustTokensReport:A,statusConsideredSuccess:P});export{N as RequestHeadersView,_ as RequestTrustTokensView};
