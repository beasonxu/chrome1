{"version":3,"file":"computed-pane-properties_test.js","sourceRoot":"","sources":["../../../../../../../../../third_party/devtools-frontend/src/test/e2e/elements/computed-pane-properties_test.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020 The Chromium Authors. All rights reserved.\n// Use of this source code is governed by a BSD-style license that can be\n// found in the LICENSE file.\n\nimport {assert} from 'chai';\n\nimport {click, getBrowserAndPages, goToResource, waitFor, waitForFunction} from '../../shared/helper.js';\nimport {describe, it} from '../../shared/mocha-extensions.js';\nimport {\n  filterComputedProperties,\n  focusElementsTree,\n  getAllPropertiesFromComputedPane,\n  getComputedPanel,\n  getComputedStyleProperties,\n  getContentOfComputedPane,\n  navigateToSidePane,\n  toggleShowAllComputedProperties,\n  waitForComputedPaneChange,\n  waitForElementsComputedSection,\n  waitForNumberOfComputedProperties,\n  waitForPartialContentOfSelectedElementsNode,\n} from '../helpers/elements-helpers.js';\n\ndescribe('The Computed pane', async function() {\n  beforeEach(async function() {\n    await goToResource('elements/simple-styled-page.html');\n    await navigateToSidePane('Computed');\n    await waitForElementsComputedSection();\n    // Note that navigating to the computed pane moved focus away from the\n    // elements pane. Restore it.\n    await focusElementsTree();\n  });\n\n  it('can display the CSS properties of the selected element', async () => {\n    const {frontend} = getBrowserAndPages();\n\n    // Select the H1 element and wait for the computed pane to change.\n    let content = await getContentOfComputedPane();\n    await frontend.keyboard.press('ArrowDown');\n    await waitForComputedPaneChange(content);\n    await waitForElementsComputedSection();\n\n    const h1Properties = await getAllPropertiesFromComputedPane();\n    assert.strictEqual(h1Properties.length, 10, 'There should be 10 computed properties on the H1 element');\n\n    const colorProperty = h1Properties.find(property => property && property.name === 'color');\n    assert.exists(colorProperty, 'H1 element should have a color computed property');\n    assert.deepEqual(colorProperty, {\n      name: 'color',\n      value: 'rgb(255, 0, 102)',\n    });\n\n    // Select the H2 element by pressing down again.\n    content = await getContentOfComputedPane();\n    await frontend.keyboard.press('ArrowDown');\n    await waitForComputedPaneChange(content);\n    await waitForElementsComputedSection();\n\n    const h2Properties = await getAllPropertiesFromComputedPane();\n    assert.strictEqual(h2Properties.length, 11, 'There should be 11 computed properties on the H2 element');\n\n    const backgroundProperty = h2Properties.find(property => property && property.name === 'background-color');\n    assert.exists(backgroundProperty, 'H2 element should have a background-color computed property');\n    assert.deepEqual(backgroundProperty, {\n      name: 'background-color',\n      value: 'rgb(255, 215, 0)',\n    });\n  });\n\n  it('can display inherited CSS properties of the selected element', async () => {\n    const {frontend} = getBrowserAndPages();\n\n    // Select the H1 element and wait for the computed pane to change.\n    const content = await getContentOfComputedPane();\n    await frontend.keyboard.press('ArrowDown');\n    await waitForComputedPaneChange(content);\n\n    await toggleShowAllComputedProperties();\n    await waitForElementsComputedSection();\n\n    const getAlignContentProperty = async () => {\n      const allH1Properties = await getAllPropertiesFromComputedPane();\n      const prop = allH1Properties.find(property => property && property.name === 'align-content');\n      return prop;\n    };\n    const alignContentProperty = await waitForFunction(getAlignContentProperty);\n    assert.exists(alignContentProperty, 'H1 element should display the inherited align-content computed property');\n    assert.deepEqual(alignContentProperty, {\n      name: 'align-content',\n      value: 'normal',\n    });\n  });\n\n  it('remembers which properties that are expanded when re-rendering', async () => {\n    const {frontend} = getBrowserAndPages();\n    await frontend.keyboard.press('ArrowDown');\n    const colorProperty = await waitFor(\n        'CSS property name: color : CSS property value: rgb(255, 0, 102) ;', undefined, undefined, 'aria');\n    const arrowIcon = await waitFor('.arrow-icon', colorProperty);\n    await click(arrowIcon);\n    const isExpandedBefore = await colorProperty.evaluate(element => element.ariaExpanded);\n    assert(isExpandedBefore);\n    await focusElementsTree();\n    await frontend.keyboard.press('ArrowDown');\n    const colorPropertyAfter =\n        await waitFor('CSS property name: color : CSS property value: rgb(0, 0, 0) ;', undefined, undefined, 'aria');\n    const isExpandedAfter = await colorPropertyAfter.evaluate(element => element.ariaExpanded);\n    assert(isExpandedAfter);\n  });\n\n  // Flaky - has been occasionally timeouting on mac.\n  it.skipOnPlatforms(['mac'], '[crbug.com/1346261] allows tracing to style rules (ported layout test)', async () => {\n    const {frontend} = getBrowserAndPages();\n    await goToResource('elements/css-styles-variables.html');\n    await waitForNumberOfComputedProperties(7);\n    await toggleShowAllComputedProperties();\n    await filterComputedProperties('--');\n    await waitForNumberOfComputedProperties(1);\n    await focusElementsTree();\n    await frontend.keyboard.press('ArrowRight');\n    await frontend.keyboard.press('ArrowRight');\n    await waitForPartialContentOfSelectedElementsNode('\"id1\"');\n    await waitForNumberOfComputedProperties(2);\n    const computedPane = await getComputedPanel();\n    await computedPane.$$eval(\n        'pierce/.arrow-icon', elements => elements.map(element => (element as HTMLElement).click()));\n    const expectedPropId1 = [\n      {\n        'name': '--a',\n        'value': ' red',\n        'trace': [{\n          'value': 'red',\n          'selector': 'body',\n          'link': 'css-styles-variables.html:8',\n        }],\n      },\n      {\n        'name': '--b',\n        'value': ' 44px',\n        'trace': [{\n          'value': '44px',\n          'selector': '#id1',\n          'link': 'css-styles-variables.html:12',\n        }],\n      },\n    ];\n    await waitForFunction(\n        async () => JSON.stringify(await getComputedStyleProperties()) === JSON.stringify(expectedPropId1));\n    await frontend.keyboard.press('ArrowRight');\n    await frontend.keyboard.press('ArrowRight');\n    await waitForPartialContentOfSelectedElementsNode('\"id2\"');\n    const expectedPropId2 = [\n      {\n        'name': '--a',\n        'value': ' green',\n        'trace': [\n          {\n            'value': 'green',\n            'selector': '#id2',\n            'link': 'css-styles-variables.html:16',\n          },\n          {\n            'value': 'red',\n            'selector': 'body',\n            'link': 'css-styles-variables.html:8',\n          },\n        ],\n      },\n      {\n        'name': '--b',\n        'value': ' 44px',\n        'trace': [{\n          'value': '44px',\n          'selector': '#id1',\n          'link': 'css-styles-variables.html:12',\n        }],\n      },\n    ];\n    await waitForFunction(\n        async () => JSON.stringify(await getComputedStyleProperties()) === JSON.stringify(expectedPropId2));\n    await frontend.keyboard.press('ArrowRight');\n    await frontend.keyboard.press('ArrowRight');\n    await waitForPartialContentOfSelectedElementsNode('\"id3\"');\n    const expectedPropId3 = [\n      {\n        'name': '--a',\n        'value': ' green',\n        'trace': [\n          {\n            'value': 'inherit',\n            'selector': '#id3',\n            'link': 'css-styles-variables.html:20',\n          },\n          {\n            'value': 'green',\n            'selector': '#id2',\n            'link': 'css-styles-variables.html:16',\n          },\n          {\n            'value': 'red',\n            'selector': 'body',\n            'link': 'css-styles-variables.html:8',\n          },\n        ],\n      },\n      {\n        'name': '--b',\n        'value': ' 44px',\n        'trace': [{\n          'value': '44px',\n          'selector': '#id1',\n          'link': 'css-styles-variables.html:12',\n        }],\n      },\n    ];\n    await waitForFunction(\n        async () => JSON.stringify(await getComputedStyleProperties()) === JSON.stringify(expectedPropId3));\n  });\n});\n"]}